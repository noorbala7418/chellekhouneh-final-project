# Generated by ansible playbook - gw iptables
*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
-A INPUT -p icmp -j ACCEPT
-A INPUT -p tcp -m tcp --dport 22 -j ACCEPT
-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
-A INPUT -i lo -j ACCEPT
{% if (inventory_hostname in groups.edges)%}
{% for host in groups.edges -%}
{%- for port in hostvars[inventory_hostname]['private_ports']  %}
-A INPUT -s {{ hostvars[inventory_hostname]['private_subnet'] }} -p tcp -m tcp --dport {{ port }}  -j ACCEPT
{% endfor -%}
{% for port in hostvars[inventory_hostname]['public_ports']  %}
-A INPUT -p tcp -m tcp --dport {{ port }} -j ACCEPT
{% endfor %}
{% endfor %}
{% endif %}
-A INPUT -j DROP
-A OUTPUT -o lo -j ACCEPT
COMMIT
# Completed
